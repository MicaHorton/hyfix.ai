{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/Users/mica/Projects/HYFIX/Website/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mica/Projects/HYFIX/Website/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mica/Projects/HYFIX/Website/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useEffect,useState}from'react';import{loadStripe}from'@stripe/stripe-js';import{useCookies}from'react-cookie';import{CardElement,Elements,useElements,useStripe}from'@stripe/react-stripe-js';import{getProductsInCart,createPaymentIntent}from'../../api';// Custom styling can be passed to options when creating an Element.\nvar CARD_ELEMENT_OPTIONS={style:{base:{color:'#32325d',fontFamily:'\"Helvetica Neue\" , Helvetica, sans-serif',fontSmoothing:'antialiased',fontSize:'40px','::placeholder':{color:'#aab7c4'}},invalid:{color:'#fa755a',iconColor:'#fa755a'}}};var CheckoutForm=function CheckoutForm(){var stripe=useStripe();var elements=useElements();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),clientSecret=_useState4[0],setClientSecret=_useState4[1];var _useCookies=useCookies(),_useCookies2=_slicedToArray(_useCookies,1),cookies=_useCookies2[0];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),metadata=_useState6[0],setMetadata=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),succeeded=_useState8[0],setSucceeded=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),processing=_useState10[0],setProcessing=_useState10[1];useEffect(function(){var productList=cookies.userCart;getProductsInCart(productList).then(function(products){createPaymentIntent(products).then(function(clientSecret){console.log('Payment intent success!');setClientSecret(clientSecret);}).catch(function(err){setError(err.message);});});},[]);//keeps hook to only once, intresting?\nvar handleChange=function handleChange(ev){if(ev.error){setError(ev.error.message);}else{setError(null);}};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(ev){var payload;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ev.preventDefault();setProcessing(true);_context.next=4;return stripe.confirmCardPayment(clientSecret,{payment_method:{card:elements.getElement(CardElement),billing_details:{name:ev.target.name.value}}});case 4:payload=_context.sent;if(payload.error){setError(\"Payment failed: \".concat(payload.error.message));setProcessing(false);console.log(\"[error]\",payload.error);}else{setError(null);setSucceeded(true);setProcessing(false);setMetadata(payload.paymentIntent);console.log(\"[PaymentIntent]\",payload.paymentIntent);}case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"main\",{className:\"checkout-page\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"checkout-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shipping\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Recipient Name\"}),/*#__PURE__*/_jsx(\"input\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Street Adress\"}),/*#__PURE__*/_jsx(\"input\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"City\"}),/*#__PURE__*/_jsx(\"input\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"double-input\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"State\"}),/*#__PURE__*/_jsx(\"input\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"Zip Code\"}),/*#__PURE__*/_jsx(\"input\",{})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Country\"}),/*#__PURE__*/_jsx(\"input\",{})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"card-element\",children:\"Credit or Debit Card\"}),/*#__PURE__*/_jsx(CardElement,{id:\"card-element\",options:CARD_ELEMENT_OPTIONS,onChange:handleChange}),/*#__PURE__*/_jsx(\"div\",{className:\"card-errors\",role:\"alert\",children:error})]}),/*#__PURE__*/_jsx(\"button\",{className:\"button checkout-button\",type:\"submit\",children:\"Submit Payment\"})]})});};var stripePromise=loadStripe('pk_test_51I0CsSIzd0xoN2NEasujFfk8OIEYrwO5KrdT4fYAjUiQ8iJVP1fumZ3XGDf1XJq0Q3C9I0wlsQxbtYY2xRAvP2eZ0024wl5yqd');var CheckoutPage=function CheckoutPage(){return/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,children:/*#__PURE__*/_jsx(CheckoutForm,{})});};export default CheckoutPage;/* 4242 4242 4242 4242 */","map":{"version":3,"sources":["/Users/mica/Projects/HYFIX/Website/frontend/src/components/store/Checkout.js"],"names":["React","useEffect","useState","loadStripe","useCookies","CardElement","Elements","useElements","useStripe","getProductsInCart","createPaymentIntent","CARD_ELEMENT_OPTIONS","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","CheckoutForm","stripe","elements","error","setError","clientSecret","setClientSecret","cookies","metadata","setMetadata","succeeded","setSucceeded","processing","setProcessing","productList","userCart","then","products","console","log","catch","err","message","handleChange","ev","handleSubmit","preventDefault","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","payload","paymentIntent","stripePromise","CheckoutPage"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useEffect, useState } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { useCookies } from 'react-cookie';\nimport {\n  CardElement,\n  Elements,\n  useElements,\n  useStripe\n} from '@stripe/react-stripe-js';\nimport { getProductsInCart, createPaymentIntent} from '../../api';\n\n\n// Custom styling can be passed to options when creating an Element.\nconst CARD_ELEMENT_OPTIONS = {\n  style: {\n    base: {\n      color: '#32325d',\n      fontFamily: '\"Helvetica Neue\" , Helvetica, sans-serif',\n      fontSmoothing: 'antialiased',\n      fontSize: '40px',\n      '::placeholder': {\n        color: '#aab7c4'\n      }\n    },\n    invalid: {\n      color: '#fa755a',\n      iconColor: '#fa755a'\n    }\n  }\n};\n\nconst CheckoutForm = () => {\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const [error, setError] = useState(null);\n  const [clientSecret, setClientSecret] = useState(null);\n  const [cookies] = useCookies();\n\n  const [metadata, setMetadata] = useState(null);\n  const [succeeded, setSucceeded] = useState(false);\n  const [processing, setProcessing] = useState(false);\n\n  useEffect(() => {\n    const productList = cookies.userCart;\n    getProductsInCart(productList).then((products) => { \n      \n      createPaymentIntent(products)\n      .then((clientSecret) => {\n        console.log('Payment intent success!')\n        setClientSecret(clientSecret);\n      })\n      .catch((err) => {\n        setError(err.message);\n      });\n    \n    });\n\n  }, []); //keeps hook to only once, intresting?\n\n  const handleChange = (ev) => {\n    if (ev.error) {\n      setError(ev.error.message);\n    } else {\n      setError(null);\n    }\n  }\n\n  const handleSubmit = async (ev) => {\n    ev.preventDefault();\n    setProcessing(true);\n    \n\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value,\n        },\n      },\n    });\n\n    if (payload.error) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log(\"[error]\", payload.error);\n    } else {\n      setError(null);\n      setSucceeded(true);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      console.log(\"[PaymentIntent]\", payload.paymentIntent);\n    }\n\n  };\n\n  return (\n    <main className='checkout-page'>\n      <form className='checkout-form' onSubmit={handleSubmit}>\n\n          <div className='form-section'>\n            <h2>Shipping</h2>\n\n            <label>Recipient Name</label>\n            <input />\n\n            <label>Street Adress</label>\n            <input />\n\n            <label>City</label>\n            <input />\n\n            <div className='double-input'>\n              <label>State</label>\n              <input />\n\n              <label>Zip Code</label>\n              <input />\n            </div>\n            \n\n            <label>Country</label>\n            <input />\n\n          </div>\n\n          <div className='form-section'>\n            <h2>Payment</h2>\n            <label htmlFor='card-element'>Credit or Debit Card</label>\n            <CardElement \n              id='card-element' \n              options={CARD_ELEMENT_OPTIONS} \n              onChange={handleChange}/>\n            <div className='card-errors' role='alert'>{error}</div>\n          </div>\n\n          <button className='button checkout-button' type='submit'>Submit Payment</button>\n\n      </form>\n    </main>\n    \n  );\n}\n\nconst stripePromise = loadStripe('pk_test_51I0CsSIzd0xoN2NEasujFfk8OIEYrwO5KrdT4fYAjUiQ8iJVP1fumZ3XGDf1XJq0Q3C9I0wlsQxbtYY2xRAvP2eZ0024wl5yqd');\nconst CheckoutPage = () => {\n  return (\n    <Elements stripe={stripePromise}>\n      <CheckoutForm />\n    </Elements>\n  );\n}\n\nexport default CheckoutPage; \n\n\n/* 4242 4242 4242 4242 */"]},"metadata":{},"sourceType":"module"}
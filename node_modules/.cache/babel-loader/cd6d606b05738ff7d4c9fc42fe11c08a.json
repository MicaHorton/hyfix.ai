{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mica/Projects/Websites/hyfix/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mica/Projects/Websites/hyfix/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/mica/Projects/Websites/hyfix/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{useEffect,useState}from'react';import{loadStripe}from'@stripe/stripe-js';import{useCookies}from'react-cookie';import{CardElement,Elements,useElements,useStripe}from'@stripe/react-stripe-js';import{getProductsInCart,createPaymentIntent}from'../../api';import{useHistory}from'react-router';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CARD_ELEMENT_OPTIONS={style:{base:{color:'#32325d',fontFamily:'\"Helvetica Neue\" , Helvetica, sans-serif',fontSmoothing:'antialiased',fontSize:'40px','::placeholder':{color:'#aab7c4'}},invalid:{color:'#fa755a',iconColor:'#fa755a'}}};var CheckoutForm=function CheckoutForm(){var stripe=useStripe();var elements=useElements();var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),clientSecret=_useState4[0],setClientSecret=_useState4[1];var _useCookies=useCookies(),_useCookies2=_slicedToArray(_useCookies,2),cookies=_useCookies2[0],removeCookie=_useCookies2[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,1),setMetadata=_useState6[0];// [metadata, setMetadata]\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,1),setSucceeded=_useState8[0];// [succeeded, setSucceeded] \nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,1),setProcessing=_useState10[0];// [processing, setProcessing]\nvar _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),recipient=_useState12[0],setRecipient=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),street=_useState14[0],setStreet=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),city=_useState16[0],setCity=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),theState=_useState18[0],setTheState=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),code=_useState20[0],setCode=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),country=_useState22[0],setCountry=_useState22[1];useEffect(function(){var productList=cookies.userCart;getProductsInCart(productList).then(function(products){createPaymentIntent(products).then(function(clientSecret){console.log('Payment intent success!');setClientSecret(clientSecret);}).catch(function(err){setError(err.message);});});},[cookies.userCart]);//keeps hook to only once, intresting?\nvar handlePaymentChange=function handlePaymentChange(ev){if(ev.error){setError(ev.error.message);}else{setError(null);}};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(ev){var payload;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ev.preventDefault();setProcessing(true);_context.next=4;return stripe.confirmCardPayment(clientSecret,{payment_method:{card:elements.getElement(CardElement),billing_details:{name:ev.target.name.value}},shipping:{name:recipient,address:{line1:street,city:city,state:theState,country:country,postal_code:code}}});case 4:payload=_context.sent;if(payload.error){setError(\"Payment failed: \".concat(payload.error.message));setProcessing(false);console.log(\"[error]\",payload.error);}else{setError(null);setSucceeded(true);setProcessing(false);setMetadata(payload.paymentIntent);history.push({pathname:'/store/success'});removeCookie('userCart',{path:'/'});console.log(\"[PaymentIntent]\",payload.paymentIntent);}case 6:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"main\",{className:\"checkout-page\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"checkout-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shipping\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Recipient Name\"}),/*#__PURE__*/_jsx(\"input\",{value:recipient,onChange:function onChange(e){return setRecipient(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Street Address\"}),/*#__PURE__*/_jsx(\"input\",{value:street,onChange:function onChange(e){return setStreet(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"City\"}),/*#__PURE__*/_jsx(\"input\",{value:city,onChange:function onChange(e){return setCity(e.target.value);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"double-input\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"State\"}),/*#__PURE__*/_jsx(\"input\",{value:theState,onChange:function onChange(e){return setTheState(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Zip/Postal Code\"}),/*#__PURE__*/_jsx(\"input\",{value:code,onChange:function onChange(e){return setCode(e.target.value);}})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Country\"}),/*#__PURE__*/_jsx(\"input\",{value:country,onChange:function onChange(e){return setCountry(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"card-element\",children:\"Credit or Debit Card\"}),/*#__PURE__*/_jsx(CardElement,{id:\"card-element\",options:CARD_ELEMENT_OPTIONS,onChange:handlePaymentChange}),/*#__PURE__*/_jsx(\"div\",{className:\"card-errors\",role:\"alert\",children:error})]}),/*#__PURE__*/_jsx(\"button\",{className:\"button checkout-button\",type:\"submit\",children:\"Submit Payment\"})]})});};var stripePromise=loadStripe('pk_test_51I0CsSIzd0xoN2NEasujFfk8OIEYrwO5KrdT4fYAjUiQ8iJVP1fumZ3XGDf1XJq0Q3C9I0wlsQxbtYY2xRAvP2eZ0024wl5yqd');var CheckoutPage=function CheckoutPage(){return/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,children:/*#__PURE__*/_jsx(CheckoutForm,{})});};export default CheckoutPage;/* 4242 4242 4242 4242 */","map":{"version":3,"sources":["/Users/mica/Projects/Websites/hyfix/frontend/src/pages/store/Checkout.js"],"names":["React","useEffect","useState","loadStripe","useCookies","CardElement","Elements","useElements","useStripe","getProductsInCart","createPaymentIntent","useHistory","CARD_ELEMENT_OPTIONS","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","CheckoutForm","stripe","elements","history","error","setError","clientSecret","setClientSecret","cookies","removeCookie","setMetadata","setSucceeded","setProcessing","recipient","setRecipient","street","setStreet","city","setCity","theState","setTheState","code","setCode","country","setCountry","productList","userCart","then","products","console","log","catch","err","message","handlePaymentChange","ev","handleSubmit","preventDefault","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","shipping","address","line1","state","postal_code","payload","paymentIntent","push","pathname","path","e","stripePromise","CheckoutPage"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useEffect, useState } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { useCookies } from 'react-cookie';\nimport {\n    CardElement,\n    Elements,\n    useElements,\n    useStripe\n} from '@stripe/react-stripe-js';\nimport { getProductsInCart, createPaymentIntent} from '../../api';\nimport { useHistory } from 'react-router';\n\nconst CARD_ELEMENT_OPTIONS = {\n    style: {\n        base: {\n            color: '#32325d',\n            fontFamily: '\"Helvetica Neue\" , Helvetica, sans-serif',\n            fontSmoothing: 'antialiased',\n            fontSize: '40px',\n            '::placeholder': {\n                color: '#aab7c4'\n            }\n        },\n        invalid: {\n            color: '#fa755a',\n            iconColor: '#fa755a'\n        }\n    }\n};\n\nconst CheckoutForm = () => {\n    const stripe = useStripe();\n    const elements = useElements();\n    const history = useHistory();\n\n    const [error, setError] = useState(null);\n    const [clientSecret, setClientSecret] = useState(null);\n    const [cookies, removeCookie] = useCookies();\n\n    const [setMetadata] = useState(null); // [metadata, setMetadata]\n    const [setSucceeded] = useState(false); // [succeeded, setSucceeded] \n    const [setProcessing] = useState(false); // [processing, setProcessing]\n\n    const [recipient, setRecipient] = useState(null);\n    const [street, setStreet] = useState(null);\n    const [city, setCity] = useState(null);\n    const [theState, setTheState] = useState(null);\n    const [code, setCode] = useState(null);\n    const [country, setCountry] = useState(null);\n\n    useEffect(() => {\n        const productList = cookies.userCart;\n        getProductsInCart(productList).then((products) => { \n            \n            createPaymentIntent(products)\n            .then((clientSecret) => {\n                console.log('Payment intent success!')\n                setClientSecret(clientSecret);\n            })\n            .catch((err) => {\n                setError(err.message);\n            });\n        \n        });\n\n    }, [cookies.userCart]); //keeps hook to only once, intresting?\n\n    const handlePaymentChange = (ev) => {\n        if (ev.error) {\n            setError(ev.error.message);\n        } else {\n            setError(null);\n        }\n    }\n\n    const handleSubmit = async (ev) => {\n        ev.preventDefault();\n        setProcessing(true);\n\n        const payload = await stripe.confirmCardPayment(clientSecret, {\n            payment_method: {\n                card: elements.getElement(CardElement),\n                billing_details: {\n                    name: ev.target.name.value,\n                }\n            },\n            shipping: {\n                name: recipient,\n                address: {\n                    line1: street, \n                    city: city,\n                    state: theState,\n                    country: country,\n                    postal_code: code\n                }\n            }\n        });\n\n    \n        if (payload.error) {\n            setError(`Payment failed: ${payload.error.message}`);\n            setProcessing(false);\n            console.log(\"[error]\", payload.error);\n        } else {\n            setError(null); \n            setSucceeded(true);\n            setProcessing(false);\n            setMetadata(payload.paymentIntent);\n            history.push({ pathname: '/store/success'});\n            removeCookie('userCart', { path: '/'});\n            console.log(\"[PaymentIntent]\", payload.paymentIntent)\n        }\n\n    };\n\n    return (\n        <main className='checkout-page'>\n            <form className='checkout-form' onSubmit={handleSubmit}>\n                <div className='form-section'>\n                    <h2>Shipping</h2>\n\n                    <label>Recipient Name</label>\n                    <input value={recipient} onChange={e => setRecipient(e.target.value)}/>\n\n                    <label>Street Address</label>\n                    <input value={street} onChange={e => setStreet(e.target.value)} />\n\n                    <label>City</label>\n                    <input value={city} onChange={e => setCity(e.target.value)} />\n\n                    <div className='double-input'>\n                        <label>State</label>\n                        <input value={theState} onChange={e => setTheState(e.target.value)} />\n\n                        <label>Zip/Postal Code</label>\n                        <input value={code} onChange={e => setCode(e.target.value)} />\n                    </div>\n                    \n\n                    <label>Country</label>\n                    <input value={country} onChange={e => setCountry(e.target.value)} />\n                </div>\n\n                <div className='form-section'>\n                    <h2>Payment</h2>\n                    <label htmlFor='card-element'>Credit or Debit Card</label>\n                    <CardElement \n                        id='card-element' \n                        options={CARD_ELEMENT_OPTIONS} \n                        onChange={handlePaymentChange}/>\n                    <div className='card-errors' role='alert'>{error}</div>\n                </div>\n\n                <button className='button checkout-button' type='submit'>Submit Payment</button>\n\n            </form>\n        </main>\n        );\n}\n\nconst stripePromise = loadStripe('pk_test_51I0CsSIzd0xoN2NEasujFfk8OIEYrwO5KrdT4fYAjUiQ8iJVP1fumZ3XGDf1XJq0Q3C9I0wlsQxbtYY2xRAvP2eZ0024wl5yqd');\nconst CheckoutPage = () => {\n        return (\n          <Elements stripe={stripePromise}>\n            <CheckoutForm />\n        </Elements>\n    );\n}\n\nexport default CheckoutPage; \n\n\n/* 4242 4242 4242 4242 */"]},"metadata":{},"sourceType":"module"}
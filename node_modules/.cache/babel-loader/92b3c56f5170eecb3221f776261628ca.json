{"ast":null,"code":"var _jsxFileName = \"/Users/mica/Projects/Websites/hyfix/frontend/src/pages/store/Checkout.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useEffect, useState } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { useCookies } from 'react-cookie';\nimport { CardElement, Elements, useElements, useStripe } from '@stripe/react-stripe-js';\nimport { getProductsInCart, createPaymentIntent } from '../../api';\nimport { useHistory } from 'react-router';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nrequire('dotenv').config();\n\nconst CARD_ELEMENT_OPTIONS = {\n  style: {\n    base: {\n      color: '#32325d',\n      fontFamily: '\"Helvetica Neue\" , Helvetica, sans-serif',\n      fontSmoothing: 'antialiased',\n      fontSize: '40px',\n      '::placeholder': {\n        color: '#aab7c4'\n      }\n    },\n    invalid: {\n      color: '#fa755a',\n      iconColor: '#fa755a'\n    }\n  }\n};\n\nconst CheckoutForm = () => {\n  _s();\n\n  const stripe = useStripe();\n  const elements = useElements();\n  const history = useHistory();\n  const [error, setError] = useState(null);\n  const [clientSecret, setClientSecret] = useState(null);\n  const [cookies, removeCookie] = useCookies();\n  const [metadata, setMetadata] = useState(null);\n  const [succeeded, setSucceeded] = useState(false);\n  const [processing, setProcessing] = useState(false);\n  const [recipient, setRecipient] = useState(null);\n  const [street, setStreet] = useState(null);\n  const [city, setCity] = useState(null);\n  const [theState, setTheState] = useState(null);\n  const [code, setCode] = useState(null);\n  const [country, setCountry] = useState(null);\n  useEffect(() => {\n    const productList = cookies.userCart;\n    console.log(productList);\n    getProductsInCart(productList).then(products => {\n      createPaymentIntent(products).then(clientSecret => {\n        setClientSecret(clientSecret);\n      }).catch(err => {\n        setError(err.message);\n      });\n    });\n  }, [cookies.userCart]);\n\n  const handlePaymentChange = ev => {\n    if (ev.error) {\n      setError(ev.error.message);\n    } else {\n      setError(null);\n    }\n  };\n\n  const handleSubmit = async ev => {\n    ev.preventDefault();\n    setProcessing(true);\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: ev.target.name.value\n        }\n      },\n      shipping: {\n        name: recipient,\n        address: {\n          line1: street,\n          city: city,\n          state: theState,\n          country: country,\n          postal_code: code\n        }\n      }\n    });\n\n    if (payload.error) {\n      setError(`Payment failed: ${payload.error.message}`);\n      setProcessing(false);\n      console.log('[error]', payload.error);\n    } else {\n      setError(null);\n      setSucceeded(true);\n      setProcessing(false);\n      setMetadata(payload.paymentIntent);\n      history.push({\n        pathname: '/store/success'\n      });\n      removeCookie('userCart', {\n        path: '/'\n      });\n      console.log('[PaymentIntent]', payload.paymentIntent);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"main\", {\n    className: \"checkout-page\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"checkout-form\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Shipping\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Recipient Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: recipient,\n          onChange: e => setRecipient(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Street Address\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: street,\n          onChange: e => setStreet(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"City\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: city,\n          onChange: e => setCity(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"double-input\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"State\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: theState,\n            onChange: e => setTheState(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Zip/Postal Code\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            value: code,\n            onChange: e => setCode(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Country\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          value: country,\n          onChange: e => setCountry(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Payment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"card-element\",\n          children: \"Credit or Debit Card\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(CardElement, {\n          id: \"card-element\",\n          options: CARD_ELEMENT_OPTIONS,\n          onChange: handlePaymentChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-errors\",\n          role: \"alert\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button checkout-button\",\n        type: \"submit\",\n        children: \"Submit Payment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CheckoutForm, \"qD4fL2z52s7iJXFPz6LecA7xEXs=\", false, function () {\n  return [useStripe, useElements, useHistory, useCookies];\n});\n\n_c = CheckoutForm;\nconst stripePromise = loadStripe(process.env.CLIENT_SECRET);\n\nconst CheckoutPage = () => {\n  return /*#__PURE__*/_jsxDEV(Elements, {\n    stripe: stripePromise,\n    children: /*#__PURE__*/_jsxDEV(CheckoutForm, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 9\n  }, this);\n};\n\n_c2 = CheckoutPage;\nexport default CheckoutPage;\n/* 4242 4242 4242 4242 */\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CheckoutForm\");\n$RefreshReg$(_c2, \"CheckoutPage\");","map":{"version":3,"sources":["/Users/mica/Projects/Websites/hyfix/frontend/src/pages/store/Checkout.js"],"names":["React","useEffect","useState","loadStripe","useCookies","CardElement","Elements","useElements","useStripe","getProductsInCart","createPaymentIntent","useHistory","require","config","CARD_ELEMENT_OPTIONS","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","CheckoutForm","stripe","elements","history","error","setError","clientSecret","setClientSecret","cookies","removeCookie","metadata","setMetadata","succeeded","setSucceeded","processing","setProcessing","recipient","setRecipient","street","setStreet","city","setCity","theState","setTheState","code","setCode","country","setCountry","productList","userCart","console","log","then","products","catch","err","message","handlePaymentChange","ev","handleSubmit","preventDefault","payload","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","shipping","address","line1","state","postal_code","paymentIntent","push","pathname","path","e","stripePromise","process","env","CLIENT_SECRET","CheckoutPage"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { useEffect, useState } from 'react'\nimport { loadStripe } from '@stripe/stripe-js'\nimport { useCookies } from 'react-cookie'\nimport {\n    CardElement,\n    Elements,\n    useElements,\n    useStripe\n} from '@stripe/react-stripe-js'\nimport { getProductsInCart, createPaymentIntent } from '../../api'\nimport { useHistory } from 'react-router'\nrequire('dotenv').config()\n\nconst CARD_ELEMENT_OPTIONS = {\n    style: {\n        base: {\n            color: '#32325d',\n            fontFamily: '\"Helvetica Neue\" , Helvetica, sans-serif',\n            fontSmoothing: 'antialiased',\n            fontSize: '40px',\n            '::placeholder': {\n                color: '#aab7c4'\n            }\n        },\n        invalid: {\n            color: '#fa755a',\n            iconColor: '#fa755a'\n        }\n    }\n}\n\nconst CheckoutForm = () => {\n    const stripe = useStripe()\n    const elements = useElements()\n    const history = useHistory()\n\n    const [error, setError] = useState(null)\n    const [clientSecret, setClientSecret] = useState(null)\n    const [cookies, removeCookie] = useCookies()\n\n    const [metadata, setMetadata] = useState(null)\n    const [succeeded, setSucceeded] = useState(false)\n    const [processing, setProcessing] = useState(false)\n\n    const [recipient, setRecipient] = useState(null)\n    const [street, setStreet] = useState(null)\n    const [city, setCity] = useState(null)\n    const [theState, setTheState] = useState(null)\n    const [code, setCode] = useState(null)\n    const [country, setCountry] = useState(null)\n\n    useEffect(() => {\n        const productList = cookies.userCart\n        console.log(productList)\n\n        getProductsInCart(productList).then((products) => {\n            createPaymentIntent(products)\n                .then((clientSecret) => {\n                    setClientSecret(clientSecret)\n                })\n                .catch((err) => {\n                    setError(err.message)\n                })\n        })\n    }, [cookies.userCart])\n\n    const handlePaymentChange = (ev) => {\n        if (ev.error) {\n            setError(ev.error.message)\n        } else {\n            setError(null)\n        }\n    }\n\n    const handleSubmit = async (ev) => {\n        ev.preventDefault()\n        setProcessing(true)\n\n        const payload = await stripe.confirmCardPayment(clientSecret, {\n            payment_method: {\n                card: elements.getElement(CardElement),\n                billing_details: {\n                    name: ev.target.name.value\n                }\n            },\n            shipping: {\n                name: recipient,\n                address: {\n                    line1: street,\n                    city: city,\n                    state: theState,\n                    country: country,\n                    postal_code: code\n                }\n            }\n        })\n\n        if (payload.error) {\n            setError(`Payment failed: ${payload.error.message}`)\n            setProcessing(false)\n            console.log('[error]', payload.error)\n        } else {\n            setError(null)\n            setSucceeded(true)\n            setProcessing(false)\n            setMetadata(payload.paymentIntent)\n            history.push({ pathname: '/store/success' })\n            removeCookie('userCart', { path: '/' })\n            console.log('[PaymentIntent]', payload.paymentIntent)\n        }\n    }\n\n    return (\n        <main className=\"checkout-page\">\n            <form className=\"checkout-form\" onSubmit={handleSubmit}>\n                <div className=\"form-section\">\n                    <h2>Shipping</h2>\n\n                    <label>Recipient Name</label>\n                    <input\n                        value={recipient}\n                        onChange={(e) => setRecipient(e.target.value)}\n                    />\n\n                    <label>Street Address</label>\n                    <input\n                        value={street}\n                        onChange={(e) => setStreet(e.target.value)}\n                    />\n\n                    <label>City</label>\n                    <input\n                        value={city}\n                        onChange={(e) => setCity(e.target.value)}\n                    />\n\n                    <div className=\"double-input\">\n                        <label>State</label>\n                        <input\n                            value={theState}\n                            onChange={(e) => setTheState(e.target.value)}\n                        />\n\n                        <label>Zip/Postal Code</label>\n                        <input\n                            value={code}\n                            onChange={(e) => setCode(e.target.value)}\n                        />\n                    </div>\n\n                    <label>Country</label>\n                    <input\n                        value={country}\n                        onChange={(e) => setCountry(e.target.value)}\n                    />\n                </div>\n\n                <div className=\"form-section\">\n                    <h2>Payment</h2>\n                    <label htmlFor=\"card-element\">Credit or Debit Card</label>\n                    <CardElement\n                        id=\"card-element\"\n                        options={CARD_ELEMENT_OPTIONS}\n                        onChange={handlePaymentChange}\n                    />\n                    <div className=\"card-errors\" role=\"alert\">\n                        {error}\n                    </div>\n                </div>\n\n                <button className=\"button checkout-button\" type=\"submit\">\n                    Submit Payment\n                </button>\n            </form>\n        </main>\n    )\n}\n\nconst stripePromise = loadStripe(process.env.CLIENT_SECRET)\n\nconst CheckoutPage = () => {\n    return (\n        <Elements stripe={stripePromise}>\n            <CheckoutForm />\n        </Elements>\n    )\n}\n\nexport default CheckoutPage\n\n/* 4242 4242 4242 4242 */\n"]},"metadata":{},"sourceType":"module"}